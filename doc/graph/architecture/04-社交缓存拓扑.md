# P1 社交缓存拓扑

**中文说明：** 展示社交域缓存拓扑：好友、黑名单、申请与未读计数在 Redis 与 MySQL 的对应关系。

## 过程讲解

1. 组件分层：图中从左到右展示调用方、业务服务和存储层，先看主链路再看旁路。
2. 数据流向：箭头表示请求或数据流方向，重点关注跨服务调用点与异步通道（如 Kafka）。
3. 关键依赖：底部存储节点体现最终落点，便于定位一致性边界、性能瓶颈和故障恢复路径。

```mermaid
flowchart LR
    FriendSvc --> FriendRepo
    ApplySvc --> ApplyRepo
    BlacklistSvc --> BlacklistRepo

    FriendRepo <--> RF[(Redis friend hash)]
    ApplyRepo <--> RA[(Redis apply pending zset)]
    ApplyRepo <--> RN[(Redis unread counter)]
    BlacklistRepo <--> RB[(Redis blacklist zset)]

    FriendRepo <--> DB[(MySQL user_relation)]
    ApplyRepo <--> DA[(MySQL apply_request)]
    BlacklistRepo <--> DB
```

