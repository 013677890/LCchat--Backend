# P0 活跃时间窗口状态机

**中文说明：** 展示活跃时间窗口状态：根据 OnlineWindow 判断 Active、Stale、Offline 的变化。

## 过程讲解

1. 初始状态：从 `[ * ]` 进入系统初始态，表示对象刚创建或刚建立连接时的默认状态。
2. 迁移条件：每条箭头代表一次状态迁移，触发条件通常是事件输入、超时、校验结果或业务操作。
3. 收敛与回环：终态表示流程结束；回环表示系统会在运行期持续重复该状态转换。

```mermaid
stateDiagram-v2
    [*] --> Unknown
    Unknown --> Active: zset score exists
    Active --> Active: new heartbeat/update
    Active --> Stale: now - score > online_window
    Stale --> Offline: session not online or stale
    Stale --> Active: receive new active update
    Offline --> Active: login/heartbeat write active
```

